--- /data4/sles/ooo-buildNow/ooo-build/build/ooc680-m5/basic/source/inc/scanner.hxx	2005-09-29 19:41:38.000000000 +0100
+++ basic/source/inc/scanner.hxx	2006-06-21 10:43:43.000000000 +0100
@@ -79,7 +79,8 @@ protected:
 	BOOL   bHash;						// TRUE: # eingelesen
 	BOOL   bError;						// TRUE: Fehler generieren
 	BOOL   bUsedForHilite;				// TRUE: Nutzung fuer Highlighting
-	BOOL   bCompatible; 				// TRUE: OPTION Compatible
+	BOOL   bCompatible; 				// TRUE: OPTION Compatibl
+	BOOL   bVBASupportOn;				// TRUE: OPTION VBASupport 1 otherwise default False
 	BOOL   bPrevLineExtentsComment;		// TRUE: Previous line is comment and ends on "... _"
 
 	void   GenError( SbError );
@@ -91,6 +92,8 @@ public:
 	BOOL  IsHash()					{ return bHash;   }
 	BOOL  IsCompatible()			{ return bCompatible; }
 	void  SetCompatible( bool b )	{ bCompatible = b; }		// #118206
+	BOOL  IsVBASupportOn()			{ return bVBASupportOn; }
+	void  SetVBASupportOn( bool b )	{ bVBASupportOn = b; }
 	BOOL  WhiteSpace()				{ return bSpaces; }
 	short GetErrors()				{ return nErrors; }
 	short GetLine()					{ return nLine;   }
--- /data4/sles/ooo-buildNow/ooo-build/build/ooc680-m5/basic/source/inc/parser.hxx	2006-06-10 17:43:14.000000000 +0100
+++ basic/source/inc/parser.hxx	2006-06-21 10:40:46.000000000 +0100
@@ -94,7 +94,6 @@ public:
 	BOOL		  bText;			// OPTION COMPARE TEXT
 	BOOL          bExplicit; 		// TRUE: OPTION EXPLICIT
 	BOOL          bClassModule;		// TRUE: OPTION ClassModule
-	BOOL          bVBASupportOn;		// TRUE: OPTION VBASupport 1 otherwise default False
 	IfaceVector   aIfaceVector;		// Holds all interfaces implemented by a class module
 	SbxDataType   eDefTypes[26];	// DEFxxx-Datentypen
 
--- /data4/sles/ooo-buildNow/ooo-build/build/ooc680-m5/basic/source/comp/scanner.cxx	2006-06-10 17:43:14.000000000 +0100
+++ basic/source/comp/scanner.cxx	2006-06-21 10:46:38.000000000 +0100
@@ -77,6 +77,7 @@ SbiScanner::SbiScanner( const ::rtl::OUS
 	bSymbol  =
 	bUsedForHilite =
 	bCompatible = 
+	bVBASupportOn = 
 	bPrevLineExtentsComment = FALSE;
 	bHash    =
 	bErrors  = TRUE;
@@ -426,7 +427,7 @@ BOOL SbiScanner::NextSym()
 		}
 #ifdef ENABLE_VBA	
 		// If VBA Interop then doen't eat the [] chars	
-		if ( cSep == ']' && SbiRuntime::isVBAEnabled() )
+		if ( cSep == ']' && bVBASupportOn )
 			aSym = aLine.copy( n - 1, nCol - n  + 1);
 		else
 			aSym = aLine.copy( n, nCol - n - 1 );
--- /data4/sles/ooo-buildNow/ooo-build/build/ooc680-m5/basic/source/comp/parser.cxx	2006-06-10 17:43:14.000000000 +0100
+++ basic/source/comp/parser.cxx	2006-06-21 10:41:08.000000000 +0100
@@ -151,7 +151,6 @@ SbiParser::SbiParser( StarBASIC* pb, SbM
 	bSingleLineIf =
 	bExplicit = FALSE;
 	bClassModule = FALSE;
-	bVBASupportOn = FALSE;
 	pPool	 = &aPublics;
 	for( short i = 0; i < 26; i++ )
 		eDefTypes[ i ] = SbxVARIANT;    // Kein expliziter Defaulttyp
--- /data4/sles/ooo-buildNow/ooo-build/build/ooc680-m5/basic/source/comp/codegen.cxx	2006-06-10 17:43:14.000000000 +0100
+++ basic/source/comp/codegen.cxx	2006-06-21 10:45:58.000000000 +0100
@@ -136,7 +136,7 @@ void SbiCodeGen::Save()
 	// OPTION EXPLICIT-Flag uebernehmen
 	if( pParser->bExplicit )
 		p->SetFlag( SBIMG_EXPLICIT );
-	if( pParser->bVBASupportOn )
+	if( pParser->IsVBASupportOn() )
 		p->SetFlag( SBIMG_VBASUPPORT );
 	
 	int nIfaceCount = 0;
