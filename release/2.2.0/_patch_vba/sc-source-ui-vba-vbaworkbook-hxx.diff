--- sc/source/ui/vba//vbaworkbook.hxx	
+++ sc/source/ui/vba//vbaworkbook.hxx
@@ -35,27 +35,24 @@
 #ifndef SC_VBA_WORKBOOK_HXX
 #define SC_VBA_WORKBOOK_HXX
 
-#include <cppuhelper/implbase1.hxx>
-
 #include <com/sun/star/frame/XModel.hpp>
 #include <org/openoffice/excel/XWorkbook.hpp>
-#include "vbahelper.hxx"
+#include "vbahelperinterface.hxx"
 
 class ScModelObj;
 
-typedef ::cppu::WeakImplHelper1< oo::excel::XWorkbook > ScVbaWorkbook_BASE;
+typedef InheritedHelperInterfaceImpl1< oo::excel::XWorkbook > ScVbaWorkbook_BASE;
 
 class ScVbaWorkbook : public ScVbaWorkbook_BASE
 {
 	css::uno::Reference< css::frame::XModel > mxModel;
-	css::uno::Reference< css::uno::XComponentContext > m_xContext;
 protected:
+
 	virtual css::uno::Reference< css::frame::XModel >  getModel() { return mxModel; }
-	ScVbaWorkbook( 	css::uno::Reference< css::uno::XComponentContext >& xContext) : mxModel(NULL), m_xContext( xContext ){}
+	ScVbaWorkbook( 	const css::uno::Reference< oo::vba::XHelperInterface >& xParent, const css::uno::Reference< css::uno::XComponentContext >& xContext) :ScVbaWorkbook_BASE( xParent, xContext ), mxModel(NULL){}
 public:
-	ScVbaWorkbook( 	css::uno::Reference< css::uno::XComponentContext >& xContext,
-			css::uno::Reference< css::frame::XModel > xModel ) :
- 			mxModel( xModel ), m_xContext( xContext ){}
+	ScVbaWorkbook( 	const css::uno::Reference< oo::vba::XHelperInterface >& xParent, const css::uno::Reference< css::uno::XComponentContext >& xContext,
+			css::uno::Reference< css::frame::XModel > xModel ) : ScVbaWorkbook_BASE( xParent, xContext ),  mxModel( xModel ) {}
 	virtual ~ScVbaWorkbook() {}
 
     // Attributes
@@ -78,6 +75,9 @@ public:
 	virtual void SAL_CALL Unprotect( const css::uno::Any &aPassword ) throw (css::uno::RuntimeException);
 	virtual void SAL_CALL Save() throw (css::uno::RuntimeException);
 	virtual void SAL_CALL Activate() throw (css::uno::RuntimeException);
+	// XHelperInterface
+	virtual rtl::OUString& getServiceImplName();
+	virtual css::uno::Sequence<rtl::OUString> getServiceNames();
 };
 
 #endif /* SC_VBA_WORKBOOK_HXX */
