? offapi/offapi.vpj
Index: offapi/com/sun/star/awt/XFont2.idl
===================================================================
RCS file: offapi/com/sun/star/awt/XFont2.idl
diff -N offapi/com/sun/star/awt/XFont2.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/awt/XFont2.idl	11 Apr 2007 09:13:09 -0000	1.1.2.2
@@ -0,0 +1,76 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: XFont2.idl,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: tbe $ $Date: 2007/04/11 09:13:09 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_awt_XFont2_idl__
+#define __com_sun_star_awt_XFont2_idl__
+
+#ifndef __com_sun_star_awt_XFont_idl__
+#include <com/sun/star/awt/XFont.idl>
+#endif 
+
+//=============================================================================
+
+module com {  module sun {  module star {  module awt {
+
+//=============================================================================
+
+/** extends the <type>XFont</type> interface and provides additional
+    information for a font.
+
+    @since CWS xmlfilter02
+ */
+interface XFont2: com::sun::star::awt::XFont
+{
+	//-------------------------------------------------------------------------
+
+	/** checks whether or not this font has all the glyphs for the text
+        specified by aText.
+
+	    @param aText
+            The specified text for which glyphs are needed.
+
+        @return
+            Returns whether or not this font has all the glyphs for the
+            specified text.
+	 */
+    boolean hasGlyphs( [in] string aText );
+
+};
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
Index: offapi/com/sun/star/awt/makefile.mk
===================================================================
RCS file: /cvs/api/offapi/com/sun/star/awt/makefile.mk,v
retrieving revision 1.41
retrieving revision 1.40.28.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.41 -r1.40.28.2
--- offapi/com/sun/star/awt/makefile.mk	20 Jun 2007 10:32:37 -0000	1.41
+++ offapi/com/sun/star/awt/makefile.mk	24 Jul 2007 16:27:52 -0000	1.40.28.2
@@ -241,6 +241,7 @@
 	XFixedText.idl\
 	XFocusListener.idl\
 	XFont.idl\
+	XFont2.idl\
 	XGraphics.idl\
 	XImageButton.idl\
 	XImageConsumer.idl\
Index: offapi/com/sun/star/sheet/ComplexReference.idl
===================================================================
RCS file: offapi/com/sun/star/sheet/ComplexReference.idl
diff -N offapi/com/sun/star/sheet/ComplexReference.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/sheet/ComplexReference.idl	23 Mar 2007 15:49:25 -0000	1.1.2.1
@@ -0,0 +1,71 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: ComplexReference.idl,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: nn $ $Date: 2007/03/23 15:49:25 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_sheet_ComplexReference_idl__
+#define __com_sun_star_sheet_ComplexReference_idl__
+
+#ifndef __com_sun_star_sheet_SingleReference_idl__
+#include <com/sun/star/sheet/SingleReference.idl>
+#endif
+
+//=============================================================================
+
+module com {  module sun {  module star {  module sheet {
+
+//=============================================================================
+
+/** contains a reference to a cell range.
+ */
+struct ComplexReference
+{
+    //-------------------------------------------------------------------------
+
+    /** is the first reference.
+     */
+    SingleReference Reference1;
+
+    //-------------------------------------------------------------------------
+
+    /** is the second reference.
+     */
+    SingleReference Reference2;
+};
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
+
Index: offapi/com/sun/star/sheet/DatabaseRange.idl
===================================================================
RCS file: /cvs/api/offapi/com/sun/star/sheet/DatabaseRange.idl,v
retrieving revision 1.13
retrieving revision 1.13.72.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.13 -r1.13.72.2
--- offapi/com/sun/star/sheet/DatabaseRange.idl	8 Sep 2005 04:37:50 -0000	1.13
+++ offapi/com/sun/star/sheet/DatabaseRange.idl	14 Aug 2007 18:29:12 -0000	1.13.72.2
@@ -151,9 +151,22 @@
 	/** specifies whether the imported data is only a selection of the database.
 
 		@since OOo 2.0.0
-
 	 */
 	[optional, property] boolean FromSelection;
+
+    //-------------------------------------------------------------------------
+
+    /** returns the index used to refer to this range in token arrays.
+
+        <p>A token describing a database range shall contain the op-code
+        OPCODE_DB_AREA and this index as data part.</p>
+
+        @see com::sun::star::sheet::FormulaToken
+        @see com::sun::star::sheet::FormulaMapGroupSpecialOffset::DB_AREA
+
+        @since OOo 2.x
+     */
+    [optional, readonly, property] long TokenIndex;
 };
 
 //=============================================================================
Index: offapi/com/sun/star/sheet/FormulaLanguage.idl
===================================================================
RCS file: offapi/com/sun/star/sheet/FormulaLanguage.idl
diff -N offapi/com/sun/star/sheet/FormulaLanguage.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/sheet/FormulaLanguage.idl	14 Aug 2007 18:29:12 -0000	1.1.2.1
@@ -0,0 +1,78 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: FormulaLanguage.idl,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: er $ $Date: 2007/08/14 18:29:12 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_sheet_FormulaLanguage_idl__
+#define __com_sun_star_sheet_FormulaLanguage_idl__
+
+//=============================================================================
+
+module com {  module sun {  module star {  module sheet {
+
+//=============================================================================
+
+/** Constants designating the formula language used with
+    <type>XFormulaOpCodeMapper</type> methods.
+ */
+constants FormulaLanguage
+{
+    /** Function names and operators as defined by the OASIS
+        OpenDocument Format (ODF) Formula specification (ODFF aka
+        OpenFormula).
+     */
+    const long ODFF     = 0;
+
+    /** Function names and operators as used in ODF documents prior to
+        the ODFF specification, up to ODF v1.1.
+     */
+    const long ODF_11   = 1;
+
+    /** Function names and operators as used in the English language
+        user interface.
+     */
+    const long ENGLISH  = 2;
+
+    /** Function names and operators as used in the current native
+        language user interface.
+     */
+    const long NATIVE   = 3;
+
+};
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
+
Index: offapi/com/sun/star/sheet/FormulaMapGroup.idl
===================================================================
RCS file: offapi/com/sun/star/sheet/FormulaMapGroup.idl
diff -N offapi/com/sun/star/sheet/FormulaMapGroup.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/sheet/FormulaMapGroup.idl	16 Aug 2007 14:45:12 -0000	1.1.2.2
@@ -0,0 +1,82 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: FormulaMapGroup.idl,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: dr $ $Date: 2007/08/16 14:45:12 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_sheet_FormulaMapGroup_idl__
+#define __com_sun_star_sheet_FormulaMapGroup_idl__
+
+//=============================================================================
+
+module com {  module sun {  module star {  module sheet {
+
+//=============================================================================
+
+/** Constants of bit masks used with
+    <member>XFormurmulaOpCodeMapper::getAvailableMappings</member> to
+    specify for which group of symbols the mappings are to be obtained.
+
+    If no bit is set, a sequence of special mappings is returned in the
+    order that is defined by <type>FormulaMapGroupSpecialOffset</type>.
+    Note that the special group and other groups are mutual exclusive.
+ */
+constants FormulaMapGroup
+{
+    /** Group of op-codes without a string symbol */
+    const long SPECIAL            = 0;
+
+    /** Separators and parentheses */
+    const long SEPARATORS         = 0x00000001;
+
+    /** Separators and parentheses for constant arrays */
+    const long ARRAY_SEPARATORS   = 0x00000002;
+
+    /** Unary operators */
+    const long UNARY_OPERATORS    = 0x00000004;
+
+    /** Binary operators */
+    const long BINARY_OPERATORS   = 0x00000008;
+
+    /** Functions */
+    const long FUNCTIONS          = 0x00000010;
+
+    /** All groups except SPECIAL */
+    const long ALL_EXCEPT_SPECIAL = 0x7fffffff;
+};
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
+
Index: offapi/com/sun/star/sheet/FormulaMapGroupSpecialOffset.idl
===================================================================
RCS file: offapi/com/sun/star/sheet/FormulaMapGroupSpecialOffset.idl
diff -N offapi/com/sun/star/sheet/FormulaMapGroupSpecialOffset.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/sheet/FormulaMapGroupSpecialOffset.idl	14 Aug 2007 18:29:12 -0000	1.1.2.1
@@ -0,0 +1,74 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: FormulaMapGroupSpecialOffset.idl,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: er $ $Date: 2007/08/14 18:29:12 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_sheet_FormulaMapGroupSpecialOffset_idl__
+#define __com_sun_star_sheet_FormulaMapGroupSpecialOffset_idl__
+
+//=============================================================================
+
+module com {  module sun {  module star {  module sheet {
+
+//=============================================================================
+
+/** Constants designating the offsets within the sequence returned by
+    <member>XFormurmulaOpCodeMapper::getAvailableMappings</member> when
+    called for group <type>FormulaMapGroup</type> SPECIAL.
+
+    The number of constants may grow in future versions!
+ */
+constants FormulaMapGroupSpecialOffset
+{
+    const long PUSH               = 0;
+    const long CALL               = 1;
+    const long STOP               = 2;
+    const long EXTERNAL           = 3;
+    const long NAME               = 4;
+    const long NO_NAME            = 5;
+    const long MISSING            = 6;
+    const long BAD                = 7;
+    const long SPACES             = 8;
+    const long MAT_REF            = 9;
+    const long DB_AREA            = 10;
+    const long MACRO              = 11;
+    const long COL_ROW_NAME       = 12;
+    const long COL_ROW_NAME_AUTO  = 13;
+};
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
+
Index: offapi/com/sun/star/sheet/FormulaOpCodeMapEntry.idl
===================================================================
RCS file: offapi/com/sun/star/sheet/FormulaOpCodeMapEntry.idl
diff -N offapi/com/sun/star/sheet/FormulaOpCodeMapEntry.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/sheet/FormulaOpCodeMapEntry.idl	14 Aug 2007 18:29:12 -0000	1.1.2.1
@@ -0,0 +1,73 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: FormulaOpCodeMapEntry.idl,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: er $ $Date: 2007/08/14 18:29:12 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_sheet_FormulaOpCodeMapEntry_idl__
+#define __com_sun_star_sheet_FormulaOpCodeMapEntry_idl__
+
+#ifndef __com_sun_star_sheet_FormulaToken_idl__
+#include <com/sun/star/sheet/FormulaToken.idl>
+#endif
+
+//=============================================================================
+
+module com {  module sun {  module star {  module sheet {
+
+//=============================================================================
+
+/** contains a mapping from a formula name (function name, operator,
+    ...) to the OpCode used by the formula compiler.
+ */
+struct FormulaOpCodeMapEntry
+{
+	//-------------------------------------------------------------------------
+
+    /** The function name, or operator.
+     */
+    string Name;
+
+    //-------------------------------------------------------------------------
+
+    /** The corresponding mapping.
+     */
+    FormulaToken Token;
+
+};
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
+
Index: offapi/com/sun/star/sheet/FormulaParser.idl
===================================================================
RCS file: offapi/com/sun/star/sheet/FormulaParser.idl
diff -N offapi/com/sun/star/sheet/FormulaParser.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/sheet/FormulaParser.idl	14 Aug 2007 18:29:12 -0000	1.1.2.2
@@ -0,0 +1,114 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: FormulaParser.idl,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: er $ $Date: 2007/08/14 18:29:12 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_sheet_FormulaParser_idl__
+#define __com_sun_star_sheet_FormulaParser_idl__
+
+#ifndef __com_sun_star_beans_PropertySet_idl__
+#include <com/sun/star/beans/PropertySet.idl>
+#endif
+#ifndef __com_sun_star_sheet_XFormulaParser_idl__
+#include <com/sun/star/sheet/XFormulaParser.idl>
+#endif
+#ifndef __com_sun_star_table_CellAddress_idl__
+#include <com/sun/star/table/CellAddress.idl>
+#endif
+#ifndef __com_sun_star_sheet_FormulaOpCodeMapEntry_idl__
+#include <com/sun/star/sheet/FormulaOpCodeMapEntry.idl>
+#endif
+
+//=============================================================================
+
+module com {  module sun {  module star {  module sheet {
+
+//=============================================================================
+
+service FormulaParser
+{
+    // ------------------------------------------------------------------------
+
+    service com::sun::star::beans::PropertySet;
+
+    // ------------------------------------------------------------------------
+
+    interface XFormulaParser;
+
+    // ------------------------------------------------------------------------
+
+    [property] com::sun::star::table::CellAddress ReferencePosition;
+
+    // ------------------------------------------------------------------------
+
+    /** Whether to use English parser and formatter.
+
+        Note: When changing this, an already existing
+        <member>OpCodeMap</member> needs to be recreated internally, so
+        for performance reasons set this _before_ setting the OpCodeMap.
+     */
+    [property] boolean CompileEnglish;
+
+    // ------------------------------------------------------------------------
+
+    [property] boolean R1C1Notation;
+
+    // ------------------------------------------------------------------------
+
+    [property] boolean Compatibility3DNotation;
+
+    // ------------------------------------------------------------------------
+
+    [property] boolean IgnoreLeadingSpaces;
+
+    // ------------------------------------------------------------------------
+
+    [property] string ParameterSeparator;
+
+    // ------------------------------------------------------------------------
+
+    /** The complete mapping of Names to OpCodes.
+
+        Names and symbols not defined here lead to a parser/print error.
+     */
+    [property] sequence< FormulaOpCodeMapEntry > OpCodeMap;
+
+    // ------------------------------------------------------------------------
+};
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
+
Index: offapi/com/sun/star/sheet/FormulaToken.idl
===================================================================
RCS file: offapi/com/sun/star/sheet/FormulaToken.idl
diff -N offapi/com/sun/star/sheet/FormulaToken.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/sheet/FormulaToken.idl	14 Aug 2007 18:29:12 -0000	1.1.2.3
@@ -0,0 +1,70 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: FormulaToken.idl,v $
+ *
+ *  $Revision: 1.1.2.3 $
+ *
+ *  last change: $Author: er $ $Date: 2007/08/14 18:29:12 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_sheet_FormulaToken_idl__
+#define __com_sun_star_sheet_FormulaToken_idl__
+
+//=============================================================================
+
+module com {  module sun {  module star {  module sheet {
+
+//=============================================================================
+
+/** contains a single token within a formula.
+ */
+struct FormulaToken
+{
+    //-------------------------------------------------------------------------
+
+    /** is the OpCode of the token.
+     */
+    long OpCode;
+
+	//-------------------------------------------------------------------------
+
+    /** is additional data in the token, depending on the OpCode.
+
+        @see com::sun::star::sheet::NamedRange::TokenIndex
+        @see com::sun::star::sheet::DatabaseRange::TokenIndex
+     */
+    any Data;
+};
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
+
Index: offapi/com/sun/star/sheet/NamedRange.idl
===================================================================
RCS file: /cvs/api/offapi/com/sun/star/sheet/NamedRange.idl,v
retrieving revision 1.6
retrieving revision 1.6.72.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.72.2
--- offapi/com/sun/star/sheet/NamedRange.idl	8 Sep 2005 04:44:39 -0000	1.6
+++ offapi/com/sun/star/sheet/NamedRange.idl	14 Aug 2007 18:29:12 -0000	1.6.72.2
@@ -78,6 +78,19 @@
 	 */
 	interface com::sun::star::sheet::XCellRangeReferrer;
 
+    //-------------------------------------------------------------------------
+
+    /** returns the index used to refer to this name in token arrays.
+
+        <p>A token describing a defined name shall contain the op-code
+        OPCODE_NAME and this index as data part.</p>
+
+        @see com::sun::star::sheet::FormulaToken
+        @see com::sun::star::sheet::FormulaMapGroupSpecialOffset::NAME
+
+        @since OOo 2.x
+     */
+    [optional, readonly, property] long TokenIndex;
 };
 
 //=============================================================================
Index: offapi/com/sun/star/sheet/NamedRanges.idl
===================================================================
RCS file: /cvs/api/offapi/com/sun/star/sheet/NamedRanges.idl,v
retrieving revision 1.6
retrieving revision 1.6.72.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.72.2
--- offapi/com/sun/star/sheet/NamedRanges.idl	8 Sep 2005 04:45:07 -0000	1.6
+++ offapi/com/sun/star/sheet/NamedRanges.idl	23 Jul 2007 13:59:24 -0000	1.6.72.2
@@ -49,6 +49,9 @@
 #ifndef __com_sun_star_container_XIndexAccess_idl__
 #include <com/sun/star/container/XIndexAccess.idl>
 #endif
+#ifndef __com_sun_star_document_XActionLockable_idl__
+#include <com/sun/star/document/XActionLockable.idl>
+#endif
 
 //=============================================================================
 
@@ -89,6 +92,14 @@
 	 */
 	interface com::sun::star::container::XEnumerationAccess;
 
+    //-------------------------------------------------------------------------
+
+    /** provides methods to control the internal update of named ranges.
+
+        @since CWS xmlfilter02
+     */
+    [optional] interface com::sun::star::document::XActionLockable;
+
 };
 
 //=============================================================================
Index: offapi/com/sun/star/sheet/ReferenceFlags.idl
===================================================================
RCS file: offapi/com/sun/star/sheet/ReferenceFlags.idl
diff -N offapi/com/sun/star/sheet/ReferenceFlags.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/sheet/ReferenceFlags.idl	23 Mar 2007 15:49:27 -0000	1.1.2.1
@@ -0,0 +1,105 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: ReferenceFlags.idl,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: nn $ $Date: 2007/03/23 15:49:27 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_sheet_ReferenceFlags_idl__
+#define __com_sun_star_sheet_ReferenceFlags_idl__
+
+//=============================================================================
+
+module com {  module sun {  module star {  module sheet {
+
+//=============================================================================
+
+/** defines flags for references.
+
+    <P>The values can be combined.</P>
+ */
+constants ReferenceFlags
+{
+	//-------------------------------------------------------------------------
+
+    /** selects a relative column reference.
+     */
+    const long COLUMN_RELATIVE = 1;
+
+	//-------------------------------------------------------------------------
+
+    /** marks a deleted column reference.
+     */
+    const long COLUMN_DELETED = 2;
+
+	//-------------------------------------------------------------------------
+
+    /** selects a relative row reference.
+     */
+    const long ROW_RELATIVE = 4;
+
+	//-------------------------------------------------------------------------
+
+    /** marks a deleted row reference.
+     */
+    const long ROW_DELETED = 8;
+
+	//-------------------------------------------------------------------------
+
+    /** selects a relative sheet reference.
+     */
+    const long SHEET_RELATIVE = 16;
+
+	//-------------------------------------------------------------------------
+
+    /** marks a deleted sheet reference.
+     */
+    const long SHEET_DELETED = 32;
+
+	//-------------------------------------------------------------------------
+
+    /** selects a 3D sheet reference.
+     */
+    const long SHEET_3D = 64;
+
+	//-------------------------------------------------------------------------
+
+    /** marks a reference from a relative range name.
+     */
+    const long RELATIVE_NAME = 128;
+};
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
+
Index: offapi/com/sun/star/sheet/SheetCell.idl
===================================================================
RCS file: /cvs/api/offapi/com/sun/star/sheet/SheetCell.idl,v
retrieving revision 1.12
retrieving revision 1.11.70.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.12 -r1.11.70.2
--- offapi/com/sun/star/sheet/SheetCell.idl	22 May 2007 15:10:25 -0000	1.12
+++ offapi/com/sun/star/sheet/SheetCell.idl	29 May 2007 09:56:20 -0000	1.11.70.2
@@ -61,6 +61,14 @@
 #include <com/sun/star/style/ParagraphProperties.idl>
 #endif
 
+#ifndef __com_sun_star_style_ParagraphPropertiesAsian_idl__
+#include <com/sun/star/style/ParagraphPropertiesAsian.idl>
+#endif
+
+#ifndef __com_sun_star_style_ParagraphPropertiesComplex_idl__
+#include <com/sun/star/style/ParagraphPropertiesComplex.idl>
+#endif
+
 #ifndef __com_sun_star_sheet_SheetRangesQuery_idl__
 #include <com/sun/star/sheet/SheetRangesQuery.idl>
 #endif
@@ -168,6 +176,18 @@
 
 	//-------------------------------------------------------------------------
 
+    /** contributes properties for paragraph formatting of Asian text.
+     */
+    [optional] service com::sun::star::style::ParagraphPropertiesAsian;
+
+    //-------------------------------------------------------------------------
+
+    /** contributes properties for paragraph formatting of Complex text.
+     */
+    [optional] service com::sun::star::style::ParagraphPropertiesComplex;
+
+    //-------------------------------------------------------------------------
+
 	/** provides interfaces to find cells with specific properties.
 	 */
 	service com::sun::star::sheet::SheetRangesQuery;
Index: offapi/com/sun/star/sheet/SingleReference.idl
===================================================================
RCS file: offapi/com/sun/star/sheet/SingleReference.idl
diff -N offapi/com/sun/star/sheet/SingleReference.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/sheet/SingleReference.idl	25 Jul 2007 08:15:52 -0000	1.1.2.2
@@ -0,0 +1,98 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: SingleReference.idl,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: dr $ $Date: 2007/07/25 08:15:52 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_sheet_SingleReference_idl__
+#define __com_sun_star_sheet_SingleReference_idl__
+
+//=============================================================================
+
+module com {  module sun {  module star {  module sheet {
+
+//=============================================================================
+
+/** contains a reference to a single cell.
+ */
+struct SingleReference
+{
+    //-------------------------------------------------------------------------
+
+    /** is the absolute column number.
+     */
+    long Column;
+
+    //-------------------------------------------------------------------------
+
+    /** is the relative column number.
+     */
+    long RelativeColumn;
+
+    //-------------------------------------------------------------------------
+
+    /** is the absolute row number.
+     */
+    long Row;
+
+    //-------------------------------------------------------------------------
+
+    /** is the relative row number.
+     */
+    long RelativeRow;
+
+    //-------------------------------------------------------------------------
+
+    /** is the absolute sheet number.
+     */
+    long Sheet;
+
+    //-------------------------------------------------------------------------
+
+    /** is the relative sheet number.
+     */
+    long RelativeSheet;
+
+	//-------------------------------------------------------------------------
+
+    /** contains flags.
+        @see ReferenceFlags
+     */
+    long Flags;
+};
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
+
Index: offapi/com/sun/star/sheet/Spreadsheet.idl
===================================================================
RCS file: /cvs/api/offapi/com/sun/star/sheet/Spreadsheet.idl,v
retrieving revision 1.9
retrieving revision 1.9.72.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.9 -r1.9.72.1
--- offapi/com/sun/star/sheet/Spreadsheet.idl	8 Sep 2005 04:52:05 -0000	1.9
+++ offapi/com/sun/star/sheet/Spreadsheet.idl	8 Jun 2007 11:56:54 -0000	1.9.72.1
@@ -224,6 +224,19 @@
 
 	//-------------------------------------------------------------------------
 
+	/** specifies the direction of the columns in the spreadsheet.
+
+	    <p>Possible values are com::sun::star::text::WritingMode2::LR_TB to
+	    order the columns from left to right, and
+            com::sun::star::text::WritingMode2::RL_TB to order the columns from
+	    right to left.</p>
+
+	    @see com::sun::star::text::WritingMode2
+	 */
+	[optional, property] short TableLayout;
+
+	//-------------------------------------------------------------------------
+
 	/** specifies whether the sheet has an automatic print area.
 
     <p> The automatic print area is used to print a sheet without
Index: offapi/com/sun/star/sheet/SpreadsheetDocumentSettings.idl
===================================================================
RCS file: /cvs/api/offapi/com/sun/star/sheet/SpreadsheetDocumentSettings.idl,v
retrieving revision 1.10
retrieving revision 1.10.72.6
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.10 -r1.10.72.6
--- offapi/com/sun/star/sheet/SpreadsheetDocumentSettings.idl	8 Sep 2005 04:52:31 -0000	1.10
+++ offapi/com/sun/star/sheet/SpreadsheetDocumentSettings.idl	20 Jul 2007 12:30:20 -0000	1.10.72.6
@@ -52,6 +52,10 @@
 #include <com/sun/star/lang/Locale.idl>
 #endif
 
+#ifndef __com_sun_star_awt_XDevice_idl__
+#include <com/sun/star/awt/XDevice.idl>
+#endif
+
 //=============================================================================
 
 module com {  module sun {  module star {  module sheet {
@@ -203,6 +207,39 @@
 	 */
 	[optional, property] com::sun::star::lang::Locale CharLocaleComplex;
 
+    //-------------------------------------------------------------------------
+
+    /** specifies whether the document data are already loaded.
+
+        @since CWS xmlfilter02
+     */
+    [optional, property] boolean IsLoaded;
+
+    //-------------------------------------------------------------------------
+
+    /** specifies whether the undo command is enabled.
+
+        @since CWS xmlfilter02
+     */
+    [optional, property] boolean IsUndoEnabled;
+
+    //-------------------------------------------------------------------------
+
+    /** specifies whether the automatic adjustment of the row height is
+        enabled.
+
+        @since CWS xmlfilter02
+     */
+    [optional, property] boolean IsAdjustHeightEnabled;
+
+    //-------------------------------------------------------------------------
+
+    /** contains the reference device used for formatting the document.
+
+        @since CWS xmlfilter02
+     */
+    [readonly, optional, property] com::sun::star::awt::XDevice ReferenceDevice;
+
 };
 
 //=============================================================================
Index: offapi/com/sun/star/sheet/XArrayFormulaTokens.idl
===================================================================
RCS file: offapi/com/sun/star/sheet/XArrayFormulaTokens.idl
diff -N offapi/com/sun/star/sheet/XArrayFormulaTokens.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/sheet/XArrayFormulaTokens.idl	28 Jun 2007 15:44:54 -0000	1.1.2.1
@@ -0,0 +1,76 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: XArrayFormulaTokens.idl,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: nn $ $Date: 2007/06/28 15:44:54 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_sheet_XArrayFormulaTokens_idl__
+#define __com_sun_star_sheet_XArrayFormulaTokens_idl__
+
+#ifndef __com_sun_star_uno_XInterface_idl__
+#include <com/sun/star/uno/XInterface.idl>
+#endif
+
+#ifndef __com_sun_star_sheet_FormulaToken_idl__
+#include <com/sun/star/sheet/FormulaToken.idl>
+#endif
+
+//=============================================================================
+
+module com {  module sun {  module star {  module sheet {
+
+//=============================================================================
+
+/** gives access to an array formula as token sequence.
+ */
+interface XArrayFormulaTokens
+{
+    //-------------------------------------------------------------------------
+
+    /** returns the array formula as sequence of tokens.
+     */
+    sequence< FormulaToken > getArrayTokens();
+
+    //-------------------------------------------------------------------------
+
+    /** sets the array formula as sequence of tokens.
+     */
+    void setArrayTokens( [in] sequence< FormulaToken > aTokens );
+
+};
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
+
Index: offapi/com/sun/star/sheet/XFormulaOpCodeMapper.idl
===================================================================
RCS file: offapi/com/sun/star/sheet/XFormulaOpCodeMapper.idl
diff -N offapi/com/sun/star/sheet/XFormulaOpCodeMapper.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/sheet/XFormulaOpCodeMapper.idl	14 Aug 2007 18:29:12 -0000	1.1.2.1
@@ -0,0 +1,166 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: XFormulaOpCodeMapper.idl,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: er $ $Date: 2007/08/14 18:29:12 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_sheet_XFormulaOpCodeMapper_idl__
+#define __com_sun_star_sheet_XFormulaOpCodeMapper_idl__
+
+#ifndef __com_sun_star_sheet_FormulaOpCodeMapEntry_idl__
+#include <com/sun/star/sheet/FormulaOpCodeMapEntry.idl>
+#endif
+
+#ifndef __com_sun_star_lang_IllegalArgumentException_idl__
+#include <com/sun/star/lang/IllegalArgumentException.idl>
+#endif
+
+//=============================================================================
+
+module com {  module sun {  module star {  module sheet {
+
+//=============================================================================
+
+/** gives access to spreadsheet compiler token interns.
+ */
+interface XFormulaOpCodeMapper
+{
+    //-------------------------------------------------------------------------
+
+    /** OpCode value used for external Add-In functions.
+
+        Needed to be able to identify which of the function names map to
+        an Add-In implementation where this OpCode is used in the
+        returned mapping and the programmatical name is available as
+        additional information.
+     */
+    [attribute, readonly] long OpCodeExternal;
+
+    //-------------------------------------------------------------------------
+
+    /** OpCode value used for unknown functions.
+
+        Used to identify which of the function names queried with
+        <member>getMappings</member> are unknown to the implementation.
+     */
+    [attribute, readonly] long OpCodeUnknown;
+
+    //-------------------------------------------------------------------------
+
+    /** returns a sequence of tokens matching the input sequence of
+        strings in order.
+
+        @param Names
+            Sequence of names to be mapped. These can be function names,
+            operators, separators and other symbols the formula compiler
+            knows.
+
+        @param Language
+            Formula language to be used, one of
+            <type>FormulaLanguage</type> constants. If a constant
+            unknown to the implementation is passed,
+            <type>com::sun::star::lang::IllegalArgumentException</type>
+            is thrown.
+
+        @returns
+            Sequence of <type>FormulaToken</type> matching the input
+            sequence in order.
+
+        Each string element in <param>Names</param> according to the
+        formula language in <param>Language</param> is mapped to a
+        <type>FormulaToken</type> containing the internal OpCode used by
+        the spreadsheet application in
+        <member>FormulaToken.OpCode</member> and by contract maybe
+        additional information in <member>FormulaToken.Data</member>.
+
+        The order of the FormulaToken sequence returned matches the
+        input order of the string sequence.
+
+        An unknown Name string gets the OpCode value of
+        <member>OpCodeUnknown</member assigned.
+
+        Additional information in <member>FormulaToken.Data</member> is
+        returned for:
+
+        Add-In names: the programmatical name. The OpCode value used for
+        Add-Ins can be queried with the <member>OpCodeExternal</member>
+        getter method.
+
+     */
+    sequence< FormulaToken > getMappings(
+            [in] sequence< string > Names,
+            [in] long Language )
+        raises( com::sun::star::lang::IllegalArgumentException );
+
+    //-------------------------------------------------------------------------
+
+    /** returns a sequence of map entries for all available elements of
+        a given formula language.
+
+        @param Language
+            Formula language to be used, one of
+            <type>FormulaLanguage</type> constants. If a constant
+            unknown to the implementation is passed,
+            <type>com::sun::star::lang::IllegalArgumentException</type>
+            is thrown.
+
+        @param Groups
+            Group of mappings to be returned, a bit mask of
+            <type>FormulaMapGroup</type> constants.
+
+        @returns
+            Sequence of <type>FormulaOpCodeMapEntry</type>.
+
+        Each element of the formula language in <param>Language</param>
+        is mapped to a <type>FormulaToken</type> containing the internal
+        OpCode used by the spreadsheet application in
+        <member>FormulaToken.OpCode</member> and by contract maybe
+        additional information in <member>FormulaToken.Data</member>.
+        See <member>getMappings</member>.
+
+     */
+    sequence< FormulaOpCodeMapEntry > getAvailableMappings(
+            [in] long Language, [in] long Groups )
+        raises( com::sun::star::lang::IllegalArgumentException );
+
+};
+
+//=============================================================================
+
+service FormulaOpCodeMapper : XFormulaOpCodeMapper;
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
+
Index: offapi/com/sun/star/sheet/XFormulaParser.idl
===================================================================
RCS file: offapi/com/sun/star/sheet/XFormulaParser.idl
diff -N offapi/com/sun/star/sheet/XFormulaParser.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/sheet/XFormulaParser.idl	23 Mar 2007 15:49:28 -0000	1.1.2.1
@@ -0,0 +1,76 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: XFormulaParser.idl,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: nn $ $Date: 2007/03/23 15:49:28 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_sheet_XFormulaParser_idl__
+#define __com_sun_star_sheet_XFormulaParser_idl__
+
+#ifndef __com_sun_star_uno_XInterface_idl__
+#include <com/sun/star/uno/XInterface.idl>
+#endif
+
+#ifndef __com_sun_star_sheet_FormulaToken_idl__
+#include <com/sun/star/sheet/FormulaToken.idl>
+#endif
+
+//=============================================================================
+
+module com {  module sun {  module star {  module sheet {
+
+//=============================================================================
+
+/** converts between text and token representations of formulas.
+ */
+interface XFormulaParser
+{
+    //-------------------------------------------------------------------------
+
+    /** parses a formula into a sequence of tokens.
+     */
+    sequence< FormulaToken > parseFormula( [in] string aFormula );
+
+    //-------------------------------------------------------------------------
+
+    /** converts a formula into a string.
+     */
+    string printFormula( [in] sequence< FormulaToken > aTokens );
+
+};
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
+
Index: offapi/com/sun/star/sheet/XFormulaTokens.idl
===================================================================
RCS file: offapi/com/sun/star/sheet/XFormulaTokens.idl
diff -N offapi/com/sun/star/sheet/XFormulaTokens.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/sheet/XFormulaTokens.idl	28 Jun 2007 15:44:54 -0000	1.1.2.2
@@ -0,0 +1,76 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: XFormulaTokens.idl,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: nn $ $Date: 2007/06/28 15:44:54 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_sheet_XFormulaTokens_idl__
+#define __com_sun_star_sheet_XFormulaTokens_idl__
+
+#ifndef __com_sun_star_uno_XInterface_idl__
+#include <com/sun/star/uno/XInterface.idl>
+#endif
+
+#ifndef __com_sun_star_sheet_FormulaToken_idl__
+#include <com/sun/star/sheet/FormulaToken.idl>
+#endif
+
+//=============================================================================
+
+module com {  module sun {  module star {  module sheet {
+
+//=============================================================================
+
+/** gives access to a formula as token sequence.
+ */
+interface XFormulaTokens
+{
+    //-------------------------------------------------------------------------
+
+    /** returns the formula as sequence of tokens.
+     */
+    sequence< FormulaToken > getTokens();
+
+    //-------------------------------------------------------------------------
+
+    /** sets the formula as sequence of tokens.
+     */
+    void setTokens( [in] sequence< FormulaToken > aTokens );
+
+};
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
+
Index: offapi/com/sun/star/sheet/XMultiFormulaTokens.idl
===================================================================
RCS file: offapi/com/sun/star/sheet/XMultiFormulaTokens.idl
diff -N offapi/com/sun/star/sheet/XMultiFormulaTokens.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/sheet/XMultiFormulaTokens.idl	9 Aug 2007 09:48:45 -0000	1.1.2.6
@@ -0,0 +1,107 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: XMultiFormulaTokens.idl,v $
+ *
+ *  $Revision: 1.1.2.6 $
+ *
+ *  last change: $Author: dr $ $Date: 2007/08/09 09:48:45 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+
+#ifndef __com_sun_star_sheet_XMultiFormulaTokens_idl__
+#define __com_sun_star_sheet_XMultiFormulaTokens_idl__
+
+#ifndef __com_sun_star_uno_XInterface_idl__
+#include <com/sun/star/uno/XInterface.idl>
+#endif
+
+#ifndef __com_sun_star_sheet_FormulaToken_idl__
+#include <com/sun/star/sheet/FormulaToken.idl>
+#endif
+
+#ifndef __com_sun_star_lang_IndexOutOfBoundsException_idl__
+#include <com/sun/star/lang/IndexOutOfBoundsException.idl>
+#endif
+
+//=============================================================================
+
+module com {  module sun {  module star {  module sheet {
+
+//=============================================================================
+
+/** gives access to multiple sets of formula tokens.
+
+    A service implementing this interface can internally set an arbitrary
+    number of formula token sequences. The number of allowed formula token
+    sequences must be returned by the
+    <member scope="com::sun::star::sheet">XMultiFormulaTokens::getCount</member>
+    method. When the client code tries to access formula tokens at index that
+    is outside the allowed index range, the implementation shall return an
+    <type scope="com::sun::star::lang">IndexOutOfBoundsException</member>.
+ */
+interface XMultiFormulaTokens
+{
+    //-------------------------------------------------------------------------
+
+    /** returns the formula at specified index as sequence of tokens.
+
+        @throws IndexOutOfBoundsException
+            If the given index lies not in the valid range then an
+            <type scope="com::sun::star::lang">IndexOutOfBoundsException</type>
+            exception is thrown.
+     */
+    sequence< FormulaToken > getTokens( [in] long nIndex )
+        raises (::com::sun::star::lang::IndexOutOfBoundsException);
+
+    //-------------------------------------------------------------------------
+
+    /** sets the formula at specified index as sequence of tokens.
+
+        @throws IndexOutOfBoundsException
+            If the given index lies not in the valid range then an
+            <type scope="com::sun::star::lang">IndexOutOfBoundsException</type>
+            exception is thrown.
+     */
+    void setTokens( [in] long nIndex, [in] sequence< FormulaToken > aTokens )
+        raises (::com::sun::star::lang::IndexOutOfBoundsException);
+
+    //-------------------------------------------------------------------------
+
+    /** returns the number of formulas allowed in this formula token set.
+
+       @return the number of formulas the implementation supports.
+     */
+    long getCount();
+};
+
+//=============================================================================
+
+}; }; }; };
+
+#endif
+
Index: offapi/com/sun/star/sheet/makefile.mk
===================================================================
RCS file: /cvs/api/offapi/com/sun/star/sheet/makefile.mk,v
retrieving revision 1.24
retrieving revision 1.23.40.7
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.24 -r1.23.40.7
--- offapi/com/sun/star/sheet/makefile.mk	22 May 2007 15:11:32 -0000	1.24
+++ offapi/com/sun/star/sheet/makefile.mk	16 Aug 2007 14:45:13 -0000	1.23.40.7
@@ -47,52 +47,20 @@
 
 IDLFILES=\
 	AccessibleCell.idl\
+	AccessibleCsvCell.idl\
+	AccessibleCsvRuler.idl\
+	AccessibleCsvTable.idl\
+	AccessiblePageHeaderFooterAreasView.idl\
 	AccessibleSpreadsheet.idl\
 	AccessibleSpreadsheetDocumentView.idl\
 	AccessibleSpreadsheetPageView.idl\
-	AccessiblePageHeaderFooterAreasView.idl\
-	AccessibleCsvRuler.idl\
-	AccessibleCsvTable.idl\
-	AccessibleCsvCell.idl\
 	ActivationEvent.idl\
-	CellAnnotationsEnumeration.idl\
-	CellAreaLinksEnumeration.idl\
-	DatabaseRangesEnumeration.idl\
-	DataPilotFieldsEnumeration.idl\
-	DataPilotItem.idl\
-	DataPilotItems.idl\
-	DataPilotItemsEnumeration.idl\
-	DataPilotTablesEnumeration.idl\
-	DDELinksEnumeration.idl\
-	FunctionCategory.idl\
-	FunctionDescriptionEnumeration.idl\
-	LabelRangesEnumeration.idl\
-	MoveDirection.idl\
-	NamedRangesEnumeration.idl\
-	ScenariosEnumeration.idl\
-	SheetCellRangesEnumeration.idl\
-	SheetLinksEnumeration.idl\
-	SpreadsheetsEnumeration.idl\
-	SpreadsheetViewPanesEnumeration.idl\
-	StatusBarFunction.idl\
-	SubTotalFieldsEnumeration.idl\
-	TableAutoFormatEnumeration.idl\
-	TableAutoFormatsEnumeration.idl\
-	TableCellStyle.idl\
-	TableConditionalEntryEnumeration.idl\
-	UniqueCellFormatRanges.idl\
-	UniqueCellFormatRangesEnumeration.idl\
-	RangeSelectionArguments.idl\
-	RangeSelectionEvent.idl\
-	XRangeSelection.idl\
-	XRangeSelectionChangeListener.idl\
-	XRangeSelectionListener.idl\
 	AddIn.idl\
 	Border.idl\
 	CellAnnotation.idl\
+	CellAnnotationShape.idl\
 	CellAnnotations.idl\
 	CellAnnotationsEnumeration.idl\
-	CellAnnotationShape.idl\
 	CellAreaLink.idl\
 	CellAreaLinks.idl\
 	CellAreaLinksEnumeration.idl\
@@ -103,12 +71,12 @@
 	CellInsertMode.idl\
 	Cells.idl\
 	CellsEnumeration.idl\
+	ComplexReference.idl\
 	ConditionOperator.idl\
 	ConsolidationDescriptor.idl\
-	DatabaseImportDescriptor.idl\
-	DatabaseRange.idl\
-	DatabaseRanges.idl\
-	DatabaseRangesEnumeration.idl\
+	DDELink.idl\
+	DDELinks.idl\
+	DDELinksEnumeration.idl\
 	DataImportMode.idl\
 	DataPilotDescriptor.idl\
 	DataPilotField.idl\
@@ -122,13 +90,16 @@
 	DataPilotFieldLayoutMode.idl\
 	DataPilotFieldOrientation.idl\
 	DataPilotFieldReference.idl\
-	DataPilotFieldReferenceType.idl\
 	DataPilotFieldReferenceItemType.idl\
+	DataPilotFieldReferenceType.idl\
 	DataPilotFieldShowItemsMode.idl\
 	DataPilotFieldSortInfo.idl\
 	DataPilotFieldSortMode.idl\
 	DataPilotFields.idl\
 	DataPilotFieldsEnumeration.idl\
+	DataPilotItem.idl\
+	DataPilotItems.idl\
+	DataPilotItemsEnumeration.idl\
 	DataPilotSource.idl\
 	DataPilotSourceDimension.idl\
 	DataPilotSourceDimensions.idl\
@@ -143,22 +114,29 @@
 	DataPilotTablesEnumeration.idl\
 	DataResult.idl\
 	DataResultFlags.idl\
-	DDELink.idl\
-	DDELinks.idl\
-	DDELinksEnumeration.idl\
+	DatabaseImportDescriptor.idl\
+	DatabaseRange.idl\
+	DatabaseRanges.idl\
+	DatabaseRangesEnumeration.idl\
 	DocumentSettings.idl\
 	FillDateMode.idl\
 	FillDirection.idl\
 	FillMode.idl\
 	FilterConnection.idl\
 	FilterOperator.idl\
+	FormulaLanguage.idl\
+	FormulaMapGroup.idl\
+	FormulaMapGroupSpecialOffset.idl\
+	FormulaOpCodeMapEntry.idl\
+	FormulaParser.idl\
 	FormulaResult.idl\
+	FormulaToken.idl\
 	FunctionAccess.idl\
 	FunctionArgument.idl\
 	FunctionCategory.idl\
 	FunctionDescription.idl\
-	FunctionDescriptions.idl\
 	FunctionDescriptionEnumeration.idl\
+	FunctionDescriptions.idl\
 	GeneralFunction.idl\
 	GlobalSheetSettings.idl\
 	GoalResult.idl\
@@ -178,6 +156,7 @@
 	RangeSelectionArguments.idl\
 	RangeSelectionEvent.idl\
 	RecentFunctions.idl\
+	ReferenceFlags.idl\
 	ResultEvent.idl\
 	Scenario.idl\
 	Scenarios.idl\
@@ -196,16 +175,17 @@
 	SheetRangesQuery.idl\
 	SheetSortDescriptor.idl\
 	SheetSortDescriptor2.idl\
+	SingleReference.idl\
 	Spreadsheet.idl\
 	SpreadsheetDocument.idl\
 	SpreadsheetDocumentSettings.idl\
 	SpreadsheetDrawPage.idl\
-	Spreadsheets.idl\
-	SpreadsheetsEnumeration.idl\
 	SpreadsheetView.idl\
 	SpreadsheetViewPane.idl\
 	SpreadsheetViewPanesEnumeration.idl\
 	SpreadsheetViewSettings.idl\
+	Spreadsheets.idl\
+	SpreadsheetsEnumeration.idl\
 	StatusBarFunction.idl\
 	SubTotalColumn.idl\
 	SubTotalDescriptor.idl\
@@ -217,6 +197,7 @@
 	TableAutoFormats.idl\
 	TableAutoFormatsEnumeration.idl\
 	TableCellStyle.idl\
+	TableCellStyle.idl\
 	TableConditionalEntry.idl\
 	TableConditionalEntryEnumeration.idl\
 	TableConditionalFormat.idl\
@@ -225,34 +206,34 @@
 	TablePageBreakData.idl\
 	TablePageStyle.idl\
 	TableValidation.idl\
+	TableValidationVisibility.idl\
 	UniqueCellFormatRanges.idl\
 	UniqueCellFormatRangesEnumeration.idl\
-	TableValidationVisibility.idl\
 	ValidationAlertStyle.idl\
 	ValidationType.idl\
 	VolatileResult.idl\
-	XActivationEventListener.idl\
 	XActivationBroadcaster.idl\
+	XActivationEventListener.idl\
 	XAddIn.idl\
 	XAreaLink.idl\
 	XAreaLinks.idl\
 	XArrayFormulaRange.idl\
+	XArrayFormulaTokens.idl\
 	XCalculatable.idl\
 	XCellAddressable.idl\
 	XCellFormatRangesSupplier.idl\
-	XCellRangesAccess.idl\
 	XCellRangeAddressable.idl\
 	XCellRangeData.idl\
 	XCellRangeFormula.idl\
 	XCellRangeMovement.idl\
 	XCellRangeReferrer.idl\
+	XCellRangesAccess.idl\
 	XCellRangesQuery.idl\
 	XCellSeries.idl\
 	XCompatibilityNames.idl\
 	XConsolidatable.idl\
 	XConsolidationDescriptor.idl\
-	XDatabaseRange.idl\
-	XDatabaseRanges.idl\
+	XDDELink.idl\
 	XDataPilotDescriptor.idl\
 	XDataPilotField.idl\
 	XDataPilotFieldGrouping.idl\
@@ -261,12 +242,16 @@
 	XDataPilotTable.idl\
 	XDataPilotTables.idl\
 	XDataPilotTablesSupplier.idl\
-	XDDELink.idl\
+	XDatabaseRange.idl\
+	XDatabaseRanges.idl\
 	XDimensionsSupplier.idl\
 	XDocumentAuditing.idl\
 	XEnhancedMouseClickBroadcaster.idl\
 	XFillAcrossSheet.idl\
+	XFormulaOpCodeMapper.idl\
+	XFormulaParser.idl\
 	XFormulaQuery.idl\
+	XFormulaTokens.idl\
 	XFunctionAccess.idl\
 	XFunctionDescriptions.idl\
 	XGoalSeek.idl\
@@ -276,6 +261,7 @@
 	XLabelRanges.idl\
 	XLevelsSupplier.idl\
 	XMembersSupplier.idl\
+	XMultiFormulaTokens.idl\
 	XMultipleOperation.idl\
 	XNamedRange.idl\
 	XNamedRanges.idl\
@@ -291,8 +277,8 @@
 	XScenariosSupplier.idl\
 	XSheetAnnotation.idl\
 	XSheetAnnotationAnchor.idl\
-	XSheetAnnotations.idl\
 	XSheetAnnotationShapeSupplier.idl\
+	XSheetAnnotations.idl\
 	XSheetAnnotationsSupplier.idl\
 	XSheetAuditing.idl\
 	XSheetCellCursor.idl\
@@ -302,9 +288,9 @@
 	XSheetCondition.idl\
 	XSheetConditionalEntries.idl\
 	XSheetConditionalEntry.idl\
+	XSheetFilterDescriptor.idl\
 	XSheetFilterable.idl\
 	XSheetFilterableEx.idl\
-	XSheetFilterDescriptor.idl\
 	XSheetLinkable.idl\
 	XSheetOperation.idl\
 	XSheetOutline.idl\
@@ -312,8 +298,8 @@
 	XSheetPastable.idl\
 	XSpreadsheet.idl\
 	XSpreadsheetDocument.idl\
-	XSpreadsheets.idl\
 	XSpreadsheetView.idl\
+	XSpreadsheets.idl\
 	XSubTotalCalculatable.idl\
 	XSubTotalDescriptor.idl\
 	XSubTotalField.idl\
@@ -324,7 +310,7 @@
 	XViewPanesSupplier.idl\
 	XViewSplitable.idl\
 	XVolatileResult.idl\
-	_NamedRange.idl\
+	_NamedRange.idl
 
 # ------------------------------------------------------------------
 
Index: offapi/com/sun/star/style/CharacterProperties.idl
===================================================================
RCS file: /cvs/api/offapi/com/sun/star/style/CharacterProperties.idl,v
retrieving revision 1.30
retrieving revision 1.29.130.3
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.30 -r1.29.130.3
--- offapi/com/sun/star/style/CharacterProperties.idl	18 Jul 2007 13:01:22 -0000	1.30
+++ offapi/com/sun/star/style/CharacterProperties.idl	24 Jul 2007 16:44:04 -0000	1.29.130.3
@@ -66,11 +66,10 @@
 
 	/** This property specifies the name of the font style.
 
-
-
 		<p>It may contain more than one name separated by comma.</p>
 	 */
 	[property] string CharFontName;
+
 	//-------------------------------------------------------------------------
 
 	/** This property contains the name of the font style.
@@ -78,21 +77,25 @@
 		<p>This property may be empty.</p>
 	 */
 	[property] string CharFontStyleName;
+
 	//-------------------------------------------------------------------------
 
-	/** This property contains font family as specified in
-		com.sun.star.awt.FontFamily .
+    /** This property contains font family.
+        @see com::sun::star::awt::FontFamily
 	 */
 	[property] short CharFontFamily;
+
 	//-------------------------------------------------------------------------
 
-	/** This property contains the text encoding of the font as specified in
-		com.sun.star.awt.CharSet.
+    /** This property contains the text encoding of the font.
+        @see com::sun::star::awt::CharSet
 	 */
 	[property] short CharFontCharSet;
+
 	//-------------------------------------------------------------------------
 
-	/** This property contains the font pitch as specified in com.sun.star.awt.FontPitch.
+    /** This property contains the font pitch.
+        @see com::sun::star::awt::FontPitch
 	 */
 	[property] short CharFontPitch;
 
@@ -108,6 +111,8 @@
 		characters.
 
         <p>Negative values denote subscripts and positive values superscripts.</p>
+
+        @see CharEscapementHeight
 	 */
 	[optional, property] short CharEscapement;
 
@@ -119,26 +124,29 @@
 
 	//-------------------------------------------------------------------------
 
-	/** This property contains the value for the character underline.@see com::sun::star::awt::FontUnderline
+    /** This property contains the value for the character underline.
+        @see com::sun::star::awt::FontUnderline
 	 */
 	[property] short CharUnderline;
 
 	//-------------------------------------------------------------------------
 
-	/** This property contains the value of the font weight.@see com::sun::star::awt::FontWeight
+    /** This property contains the value of the font weight.
+        @see com::sun::star::awt::FontWeight
 	 */
 	[property] float CharWeight;
 
 	//-------------------------------------------------------------------------
 
-	/** This property contains the value of the posture of the document.@see com::sun::star::awt::FontSlant
+    /** This property contains the value of the posture of the document.
+        @see com::sun::star::awt::FontSlant
 	 */
 	[property] com::sun::star::awt::FontSlant CharPosture;
 
 	//-------------------------------------------------------------------------
 
-	/** optional property to determine whether the kerning tables from the current font are used.
-
+    /** This optional property determines whether the kerning tables from the
+        current font are used.
 
 		<p>Automatic <em>kerning</em> applies a spacing in between certain
 		pairs of characters to make the text look better.</p>
@@ -147,19 +155,20 @@
 
 	//-------------------------------------------------------------------------
 
-	/** optional property which contains the text background color.
+    /** This optional property contains the text background color.
 	 */
 	[optional, property] com::sun::star::util::Color CharBackColor;
 
 	//-------------------------------------------------------------------------
 
-	/** determines if the text background color is set to transparent.
+    /** This property determines if the text background color is set to
+        transparent.
 	 */
 	[optional, property] boolean CharBackTransparent;
 
 	//-------------------------------------------------------------------------
 
-	/** optional property which contains the value of the case-mapping of the
+    /** This optional property contains the value of the case-mapping of the
 		text for formatting and displaying.
 
 		@see CaseMap
@@ -168,7 +177,7 @@
 
 	//-------------------------------------------------------------------------
 
-	/** This property is <TRUE/> if the character(s) is(are) crossed out.
+    /** This property is <TRUE/> if the characters are crossed out.
 	 */
 	[optional, property] boolean CharCrossedOut;
 
@@ -179,12 +188,14 @@
 	[optional, property] boolean CharFlash;
 
 	//-------------------------------------------------------------------------
-	/**	determins the type of the strike out of the character.
-		@see com.sun.star.awt.FontStrikeout
+
+    /** This property determins the type of the strike out of the character.
+        @see com::sun::star::awt::FontStrikeout
 	*/
 	[optional, property] short CharStrikeout;
 
 	//-------------------------------------------------------------------------
+
 	/**	If this property is <TRUE/>, the underline and strike-through
 		properties are not applied to white spaces.
 	 */
@@ -192,19 +203,21 @@
 
 	//-------------------------------------------------------------------------
 
-	/** optional property which contains the value of the kerning of the characters.
+    /** This optional property contains the value of the kerning of the
+        characters.
 	 */
 	[optional, property] short CharKerning;
 
 	//-------------------------------------------------------------------------
 
-	/** contains the value of the locale.
+    /** This property contains the value of the locale.
 	 */
 	[property] com::sun::star::lang::Locale CharLocale;
 
 	//-------------------------------------------------------------------------
 
-	/** optional property which marks a range of characters to prevent it from being broken into two lines.
+    /** This optional property marks a range of characters to prevent it from
+        being broken into two lines.
 
 		<p> A line break is applied before the range of characters if
 		the layout makes a break necessary within the range.</p>
@@ -213,7 +226,8 @@
 
 	//-------------------------------------------------------------------------
 
-	/** optional property which marks a range of characters to ignore a line break in this area.
+    /** This optional property marks a range of characters to ignore a line
+        break in this area.
 
 		<p> A line break is applied behind the range of characters if
 		the layout makes a break necessary within the range. That means that
@@ -223,141 +237,194 @@
 
 	//-------------------------------------------------------------------------
 
-	/** specifies if the characters are formatted and
+    /** This optional property specifies if the characters are formatted and
 		displayed with a shadow effect.
 	 */
 	[optional, property] boolean CharShadowed;
 
 	//-------------------------------------------------------------------------
 
-	/** optional property which specifies the fundamental technology of the font.
-
+    /** This optional property specifies the fundamental technology of the font.
 		@see com::sun::star::awt::FontType
 	 */
 	[optional, property] short CharFontType;
 
 	//-------------------------------------------------------------------------
 
-	/** specifies the name of the style of the font.
+    /** This optional property specifies the name of the style of the font.
 	 */
 	[optional, property] string CharStyleName;
 
 	//-------------------------------------------------------------------------
-	/** specifies if the characters are formatted and
+
+    /** This optional property specifies if the characters are formatted and
 		displayed with a contour effect.
 	 */
 	[optional, property] boolean CharContoured;
+
 	//-------------------------------------------------------------------------
-	/** determins whether text is formatted in two lines.
+
+    /** This optional property determins whether text is formatted in two lines.
+
 	 <p>It is linked to the properties CharCombinePrefix and CharCombineSuffix.</p>
 	 */
 	[optional, property] boolean CharCombineIsOn;
+
 	//-------------------------------------------------------------------------
-	/** contains the prefix (usually parenthesis) before text that is formatted in two lines.
+
+    /** This optional property contains the prefix (usually parenthesis) before
+        text that is formatted in two lines.
+
 	 <p>It is linked to the properties CharCombineIsOn and CharCombineSuffix.</p>
 	 */
 	[optional, property] string CharCombinePrefix;
+
 	//-------------------------------------------------------------------------
-	/** contains the suffix (usually parenthesis) after text that is formatted in two lines.
+
+    /** This optional property contains the suffix (usually parenthesis) after
+        text that is formatted in two lines.
+
 	 <p>It is linked to the properties CharCombineIsOn and CharCombinePrefix.</p>
 	 */
 	[optional, property] string CharCombineSuffix;
+
 	//-------------------------------------------------------------------------
-	/** contains the font emphasis value as <type scope="com::sun::star::text">FontEmphasis</type>.
+
+    /** This optional property contains the font emphasis value.
+        @see com::sun::star::text::FontEmphasis
 	 */
 	[optional, property] short CharEmphasis;
    
     //-------------------------------------------------------------------------
-    /** contains the relief value as <type scope="com::sun::star::text">FontRelief</type>.
+
+    /** This optional property contains the relief style of the characters.
+        @see com::sun::star::text::FontRelief
 	 */
     [optional, property] short CharRelief;
+
     //-------------------------------------------------------------------------
-	/** contains the text that is set as ruby.
+
+    /** This optional property contains the text that is set as ruby.
 	 */
 	[optional, property] string RubyText;
+
 	//-------------------------------------------------------------------------
-	/** determins the adjustment of the ruby text as <type scope="com::sun::star::text">RubyAdjust</type>.
+
+    /** This optional property determins the adjustment of the ruby .
+        @see com::sun::star::text::RubyAdjust
 	 */
 	[optional, property] short RubyAdjust;
+
 	//-------------------------------------------------------------------------
-	/** contains the name of the character style that is applied to RubyText.
+
+    /** This optional property contains the name of the character style that is
+        applied to RubyText.
 	 */
 	[optional, property] string RubyCharStyleName;
+
     //-------------------------------------------------------------------------
-    /** determins whether the ruby text is printed above/left or below/right of the text.
+
+    /** This optional property determins whether the ruby text is printed
+        above/left or below/right of the text.
 	 */
     [optional, property] boolean RubyIsAbove;
 
 	//-------------------------------------------------------------------------
-	/** determins the rotation of a character in tenths of a degree.
-	 	<p>Depending on the implementation only certain values may be allowed.
-		</p>
+
+    /** This optional property determins the rotation of a character in tenths
+        of a degree.
+
+       <p>Depending on the implementation only certain values may be allowed.</p>
 	 */
 	[optional, property] short CharRotation;
+
 	//-------------------------------------------------------------------------
-	/** determins whether the text formatting tries to fit rotated text into the
-	 	surrounded line height.
+
+    /** This optional property determins whether the text formatting tries to
+        fit rotated text into the surrounded line height.
 	 */
 	[optional, property] boolean CharRotationIsFitToLine;
+
 	//-------------------------------------------------------------------------
-    /** determins the percentage value for scaling the width of characters.
+
+    /** This optional property determins the percentage value for scaling the
+        width of characters.
 
         <p>The value refers to the original width which is denoted by 100,
         and it has to be greater than 0.</p>
-        
 	 */
 	[optional, property] short CharScaleWidth;
 
     //-------------------------------------------------------------------------
-    /** contains the URL of a hyperlink (if set).
+
+    /** This optional property contains the URL of a hyperlink.
      */
     [optional, property] string HyperLinkURL;
 
     //-------------------------------------------------------------------------
-    /** contains the name of the target for a hyperlink (if set).
+
+    /** This optional property contains the name of the target for a hyperlink.
      */
     [optional, property] string HyperLinkTarget;
 
     //-------------------------------------------------------------------------
-    /** contains the name of the hyperlink (if set).
+
+    /** This optional property contains the name of the hyperlink.
      */
     [optional, property] string HyperLinkName;
 
-    //--------------------------------------------------------------------
-    /** contains the character style name for visited hyperlinks.
+    //-------------------------------------------------------------------------
+
+    /** This optional property contains the character style name for visited
+        hyperlinks.
      */
     [optional, property] string VisitedCharStyleName;
 
-    //--------------------------------------------------------------------
-    /** contains the character style name for unvisited hyperlinks.
+    //-------------------------------------------------------------------------
+
+    /** This optional property contains the character style name for unvisited
+        hyperlinks.
      */
     [optional, property] string UnvisitedCharStyleName;
 
     //-------------------------------------------------------------------------
-    /** This is the additional height used for subscript or superscript
+
+    /** This is the relative height used for subscript or superscript
         characters in units of percent.
-        For subscript characters the value is negative and for
-        superscript characters positive.
+
+        <p>The value 100 denotes the original height of the characters.</p>
+
+        @see CharEscapement
      */
     [optional, property] byte CharEscapementHeight;
 
     //-------------------------------------------------------------------------
-    /** determines if the word can be hyphenated at the character.
+
+    /** This optional property determines if the word can be hyphenated at the
+        character.
      */
     [optional, property] boolean CharNoHyphenation;
 
     //-------------------------------------------------------------------------
-    /** gives the color of the underline for that character.
+
+    /** This property contains the color of the underline for the characters.
+        @see CharUnderlineHasColor
      */
     [property] com::sun::star::util::Color CharUnderlineColor;
 
     //-------------------------------------------------------------------------
-    /** specifies if the CharUnderlineColor is used for an underline.
+
+    /** This property specifies if the property CharUnderlineColor is used for
+        an underline.
+        @see CharUnderlineColor
      */
     [property] boolean CharUnderlineHasColor;
 
     //-------------------------------------------------------------------------
-    /** specifies the names of the all styles applied to the font.
+
+    /** This optional property specifies the names of the all styles applied to
+        the font.
+
         <p> It is not guaranteed that the order in the sequence reflects 
         the order of the evaluation of the character style attributes.</p>
 
@@ -366,6 +433,7 @@
     [optional, property] sequence<string> CharStyleNames;
     
     //-------------------------------------------------------------------------
+
     /** If this optional property is <TRUE/>, then the characters are invisible.
 
         @since OOo 2.0.0
@@ -373,8 +441,9 @@
     [optional, property] boolean CharHidden;
     
     //-------------------------------------------------------------------------
-    /** this property stores xml attributes.
-        They will be saved to and restored from automatic styles inside xml files.
+
+    /** This property stores XML attributes. They will be saved to and restored
+        from automatic styles inside XML files.
 
         @see com::sun::star::xml::AttributeContainer
      */
@@ -386,3 +455,4 @@
 }; }; }; };
 
 #endif
+
Index: offapi/com/sun/star/util/MeasureUnit.idl
===================================================================
RCS file: /cvs/api/offapi/com/sun/star/util/MeasureUnit.idl,v
retrieving revision 1.5
retrieving revision 1.5.72.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.5 -r1.5.72.1
--- offapi/com/sun/star/util/MeasureUnit.idl	8 Sep 2005 08:48:17 -0000	1.5
+++ offapi/com/sun/star/util/MeasureUnit.idl	20 Feb 2006 14:00:56 -0000	1.5.72.1
@@ -94,6 +94,9 @@
 
 	/** all measures for this component are in percentage */
 	const short PERCENT = 15;
+
+	/** all measures for this component are in pixel */
+	const short PIXEL = 16;
 }; 
  
 //============================================================================= 
Index: offapi/com/sun/star/xml/Attribute.idl
===================================================================
RCS file: offapi/com/sun/star/xml/Attribute.idl
diff -N offapi/com/sun/star/xml/Attribute.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/xml/Attribute.idl	1 Mar 2007 17:30:58 -0000	1.1.2.1
@@ -0,0 +1,69 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: Attribute.idl,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: cl $ $Date: 2007/03/01 17:30:58 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef __com_sun_star_xml_Attribute_idl__ 
+#define __com_sun_star_xml_Attribute_idl__ 
+ 
+//============================================================================= 
+ 
+module com {  module sun {  module star {  module xml { 
+ 
+//============================================================================= 
+ 
+/**
+ * A struct to keep information of an element's attribute.
+ */
+struct Attribute
+{
+	/**
+	 * the attribute name
+	 */
+	string Name;
+
+	/**
+	 * the attribute namespace URL
+	 */
+	string NamespaceURL;
+	
+	/**
+	 * the attribute value
+	 */
+	string Value;
+};
+ 
+//============================================================================= 
+ 
+}; }; }; };  
+
+#endif 
Index: offapi/com/sun/star/xml/makefile.mk
===================================================================
RCS file: /cvs/api/offapi/com/sun/star/xml/makefile.mk,v
retrieving revision 1.13
retrieving revision 1.13.40.1
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.13 -r1.13.40.1
--- offapi/com/sun/star/xml/makefile.mk	1 Dec 2006 17:19:40 -0000	1.13
+++ offapi/com/sun/star/xml/makefile.mk	1 Mar 2007 17:31:30 -0000	1.13.40.1
@@ -48,6 +48,7 @@
 IDLFILES=\
 	AttributeContainer.idl \
 	AttributeData.idl \
+	Attribute.idl \
 	ExportFilter.idl \
 	ImportFilter.idl \
 	NamespaceContainer.idl \
Index: offapi/com/sun/star/xml/sax/FastToken.idl
===================================================================
RCS file: offapi/com/sun/star/xml/sax/FastToken.idl
diff -N offapi/com/sun/star/xml/sax/FastToken.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/xml/sax/FastToken.idl	1 Mar 2007 17:32:03 -0000	1.1.2.1
@@ -0,0 +1,67 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: FastToken.idl,v $
+ *
+ *  $Revision: 1.1.2.1 $
+ *
+ *  last change: $Author: cl $ $Date: 2007/03/01 17:32:03 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef __com_sun_star_xml_sax_XFastToken_idl__ 
+#define __com_sun_star_xml_sax_XFastToken_idl__ 
+ 
+#ifndef __com_sun_star_uno_XInterface_idl__ 
+#include <com/sun/star/uno/XInterface.idl> 
+#endif 
+ 
+//============================================================================= 
+ 
+module com {  module sun {  module star {  module xml {  module sax {  
+ 
+//============================================================================ 
+
+constants FastToken
+{ 
+	//------------------------------------------------------------------------- 
+		
+	/** specifies an unknown token.
+	 */
+	const long DONTKNOW = -1;
+
+	//------------------------------------------------------------------------- 
+
+	/** specifies the first namespace token
+	*/
+	const long NAMESPACE = 0x00010000;
+};
+
+//============================================================================= 
+ 
+}; }; }; }; };  
+ 
+#endif 
Index: offapi/com/sun/star/xml/sax/XFastAttributeList.idl
===================================================================
RCS file: offapi/com/sun/star/xml/sax/XFastAttributeList.idl
diff -N offapi/com/sun/star/xml/sax/XFastAttributeList.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/xml/sax/XFastAttributeList.idl	1 Mar 2007 17:33:12 -0000	1.1.2.2
@@ -0,0 +1,179 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: XFastAttributeList.idl,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: cl $ $Date: 2007/03/01 17:33:12 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef __com_sun_star_xml_sax_XFastAttributeList_idl__ 
+#define __com_sun_star_xml_sax_XFastAttributeList_idl__ 
+
+#ifndef __com_sun_star_uno_XInterface_idl__ 
+#include <com/sun/star/uno/XInterface.idl> 
+#endif 
+
+#ifndef __com_sun_star_xml_Attribute_idl__
+#include <com/sun/star/xml/Attribute.idl>
+#endif
+
+#ifndef __com_sun_star_xml_sax_SAXException_idl__
+#include <com/sun/star/xml/sax/SAXException.idl>
+#endif
+
+//============================================================================= 
+ 
+module com {  module sun {  module star {  module xml {  module sax {  
+ 
+//============================================================================= 
+ 
+/** a container for the attributes of an xml element. 
+
+	<br>Attributes are seperated into known attributes and unknown attributes.
+	<p>Known attributes have a local name that is known to the <type>XFastTokenHandler</token>
+	registered at the <type>XFastParser</type> which created the sax event containing
+	this attributes. If an attribute also has a namespace, that must be registered
+	at the <type>XFastParser</type>, else this attribute is also unknown even if
+	the local name is known.
+ */
+interface XFastAttributeList: com::sun::star::uno::XInterface
+{
+	/** checks if an attribute is available.<br>
+
+		@param Token
+			contains the integer token from the <type>XFastTokenHandler</type>
+			registered at the <type>XFastParser</type>.<br>
+
+			If the attribute name has a namespace that was registered with the
+			<type>XFastParser</type>, Token contains the integer token of the
+			attributes local name from the <type>XFastTokenHandler</type> and
+			the integer token of the namespace combined with an arithmetic
+			<b>or</b> operation.
+
+		@returns
+			<TRUE/>, if the attribute is available
+	*/
+	boolean hasAttribute( [in] long Token );
+
+	/** retrieves the token of an attributes value.<br>
+
+		@param Token
+			contains the integer token from the <type>XFastTokenHandler</type>
+			registered at the <type>XFastParser</type>.<br>
+
+			If the attribute name has a namespace that was registered with the
+			<type>XFastParser</type>, Token contains the integer token of the
+			attributes local name from the <type>XFastTokenHandler</type> and
+			the integer token of the namespace combined with an arithmetic
+			<b>or</b> operation.
+
+		@returns
+			The integer token of the value from the attribute or <const>FastToken::Invalid</const>
+
+		@raises SAXEXception
+			if the attribute is not available
+
+	*/
+	long getValueToken( [in] long Token )
+		raises( SAXException );
+
+	/**retrieves the token of an attributes value.<br>
+
+		@param Token
+			contains the integer token from the <type>XFastTokenHandler</type>
+			registered at the <type>XFastParser</type>.<br>
+
+			If the attribute name has a namespace that was registered with the
+			<type>XFastParser</type>, Token contains the integer token of the
+			attributes local name from the <type>XFastTokenHandler</type> and
+			the integer token of the namespace combined with an arithmetic
+			<b>or</b> operation.
+
+		@param Default
+			This value will be returned if the attribute is not available
+
+		@returns
+			If the attribute is available it returns the integer token of the value
+			from the attribute or <const>FastToken::Invalid</const>.
+			If not the value of <param>Default</param> is returned.
+
+	*/
+	long getOptionalValueToken( [in] long Token, [in] long Default );
+
+	/** retrieves the value of an attributes.<br>
+
+		@param Token
+			contains the integer token from the <type>XFastTokenHandler</type>
+			registered at the <type>XFastParser</type>.<br>
+
+			If the attribute name has a namespace that was registered with the
+			<type>XFastParser</type>, Token contains the integer token of the
+			attributes local name from the <type>XFastTokenHandler</type> and
+			the integer token of the namespace combined with an arithmetic
+			<b>or</b> operation.
+
+		@returns
+			The string value from the attribute.
+
+		@raises SAXEXception
+			if the attribute is not available
+
+	*/
+	string getValue( [in] long Token )
+		raises( SAXException );
+
+	/** retrieves the value of an attributes.<br>
+
+		@param Token
+			contains the integer token from the <type>XFastTokenHandler</type>
+			registered at the <type>XFastParser</type>.<br>
+
+			If the attribute name has a namespace that was registered with the
+			<type>XFastParser</type>, Token contains the integer token of the
+			attributes local name from the <type>XFastTokenHandler</type> and
+			the integer token of the namespace combined with an arithmetic
+			<b>or</b> operation.
+
+		@returns
+			The string value from the attribute or an empty string if the
+			attribute is not available.
+	*/
+	string getOptionalValue( [in] long Token );
+
+	/** returns a sequence of attributes which names and or namespaces URLS
+		can not be translated to tokens.
+	*/
+	sequence< ::com::sun::star::xml::Attribute > getUnknownAttributes();
+};
+
+//============================================================================= 
+ 
+}; }; }; }; };  
+ 
+#endif 
Index: offapi/com/sun/star/xml/sax/XFastContextHandler.idl
===================================================================
RCS file: offapi/com/sun/star/xml/sax/XFastContextHandler.idl
diff -N offapi/com/sun/star/xml/sax/XFastContextHandler.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/xml/sax/XFastContextHandler.idl	1 Mar 2007 17:33:12 -0000	1.1.2.2
@@ -0,0 +1,169 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: XFastContextHandler.idl,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: cl $ $Date: 2007/03/01 17:33:12 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef __com_sun_star_xml_sax_XFastContextHandler_idl__ 
+#define __com_sun_star_xml_sax_XFastContextHandler_idl__ 
+ 
+#ifndef __com_sun_star_uno_XInterface_idl__ 
+#include <com/sun/star/uno/XInterface.idl> 
+#endif 
+ 
+#ifndef __com_sun_star_xml_sax_SAXException_idl__ 
+#include <com/sun/star/xml/sax/SAXException.idl> 
+#endif 
+ 
+#ifndef __com_sun_star_xml_sax_XFastAttributeList_idl__ 
+#include <com/sun/star/xml/sax/XFastAttributeList.idl> 
+#endif 
+ 
+#ifndef __com_sun_star_xml_sax_XLocator_idl__ 
+#include <com/sun/star/xml/sax/XLocator.idl> 
+#endif 
+ 
+ 
+//============================================================================= 
+ 
+module com {  module sun {  module star {  module xml {  module sax {  
+ 
+//============================================================================= 
+ 
+/** receives notification of sax document events from a
+	<type>XFastParser</type>.
+	
+	@see XFastDocumentHandler
+ */
+interface XFastContextHandler: com::sun::star::uno::XInterface
+{ 
+	//------------------------------------------------------------------------- 
+	 
+	/** receives notification of the beginning of an element .
+
+		@param Element
+			contains the integer token from the <type>XFastTokenHandler</type>
+			registered at the <type>XFastParser</type>.<br>
+
+			If the element has a namespace that was registered with the
+			<type>XFastParser</type>, <param>Element</param> contains the integer
+			token of the elements local name from the <type>XFastTokenHandler</type>
+			and the integer token of the namespace combined with an arithmetic
+			<b>or</b> operation.
+
+		@param Attribs
+			Contains a <type>XFastAttrbitueList</type> to access the attributes
+			from the element.
+
+	*/
+	void startFastElement( [in] long Element, [in] XFastAttributeList Attribs ) 
+			raises( com::sun::star::xml::sax::SAXException ); 
+
+	//------------------------------------------------------------------------- 
+
+	/** receives notification of the beginning of an unknown element .
+
+		@param Namespace
+			contains the namespace url (not the prefix!) of this element.
+		@param Name
+			contains the elements local name.
+		@param Attribs
+			Contains a <type>XFastAttrbitueList</type> to access the attributes
+			from the element.
+	 */
+	void startUnknownElement( [in] string Namespace, [in] string Name, [in] XFastAttributeList Attribs ) 
+			raises( com::sun::star::xml::sax::SAXException ); 
+
+	//------------------------------------------------------------------------- 
+
+	/** receives notification of the end of an known element.
+		@see startFastElement
+	 */
+	void endFastElement( [in] long Element ) 
+			raises( com::sun::star::xml::sax::SAXException ); 
+
+	//------------------------------------------------------------------------- 
+
+	/** receives notification of the end of an kown element.
+		@see startUnknownElement
+	 */
+	void endUnknownElement( [in] string Namespace, [in] string Name ) 
+			raises( com::sun::star::xml::sax::SAXException ); 
+ 
+	//------------------------------------------------------------------------- 
+	 
+	/** receives notification of the beginning of a known child element.
+
+		@param Element
+			contains the integer token from the <type>XFastTokenHandler</type>
+			registered at the <type>XFastParser</type>.
+
+			<br>If the element has a namespace that was registered with the
+			<type>XFastParser</type>, <param>Element</param> contains the
+			integer token of the elements local name from the
+			<type>XFastTokenHandler</type> and the integer token of the
+			namespace combined with an arithmetic <b>or</b> operation.
+
+		@param Attribs
+			Contains a <type>XFastAttrbitueList</type> to access the attributes
+			from the element.
+	 */
+	XFastContextHandler createFastChildContext( [in] long Element, [in] XFastAttributeList Attribs ) 
+			raises( com::sun::star::xml::sax::SAXException ); 
+
+	//------------------------------------------------------------------------- 
+	 
+	/** receives notification of the beginning of a unknown child element .
+
+		@param Namespace
+			contains the namespace url (not the prefix!) of this element.
+		@param Name
+			contains the elements local name.
+		@param Attribs
+			Contains a <type>XFastAttrbitueList</type> to access the attributes
+			the element.
+	 */
+	XFastContextHandler createUnknownChildContext( [in] string Namespace, [in] string Name, [in] XFastAttributeList Attribs ) 
+			raises( com::sun::star::xml::sax::SAXException ); 
+
+	//------------------------------------------------------------------------- 
+	 
+	/** receives notification of character data.
+	 */
+	void characters( [in] string aChars ) 
+			raises( com::sun::star::xml::sax::SAXException ); 
+  }; 
+ 
+//============================================================================= 
+ 
+}; }; }; }; };  
+ 
+#endif 
Index: offapi/com/sun/star/xml/sax/XFastDocumentHandler.idl
===================================================================
RCS file: offapi/com/sun/star/xml/sax/XFastDocumentHandler.idl
diff -N offapi/com/sun/star/xml/sax/XFastDocumentHandler.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/xml/sax/XFastDocumentHandler.idl	1 Mar 2007 17:33:12 -0000	1.1.2.3
@@ -0,0 +1,97 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: XFastDocumentHandler.idl,v $
+ *
+ *  $Revision: 1.1.2.3 $
+ *
+ *  last change: $Author: cl $ $Date: 2007/03/01 17:33:12 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef __com_sun_star_xml_sax_XFastDocumentHandler_idl__ 
+#define __com_sun_star_xml_sax_XFastDocumentHandler_idl__ 
+ 
+#ifndef __com_sun_star_uno_XInterface_idl__ 
+#include <com/sun/star/uno/XInterface.idl> 
+#endif 
+ 
+#ifndef __com_sun_star_xml_sax_SAXException_idl__ 
+#include <com/sun/star/xml/sax/SAXException.idl> 
+#endif 
+ 
+#ifndef __com_sun_star_xml_sax_XFastAttributeList_idl__ 
+#include <com/sun/star/xml/sax/XFastAttributeList.idl> 
+#endif 
+
+#ifndef __com_sun_star_xml_sax_XFastContextHandler_idl__ 
+#include <com/sun/star/xml/sax/XFastContextHandler.idl> 
+#endif 
+
+#ifndef __com_sun_star_xml_sax_XLocator_idl__ 
+#include <com/sun/star/xml/sax/XLocator.idl> 
+#endif 
+ 
+ 
+//============================================================================= 
+ 
+module com {  module sun {  module star {  module xml {  module sax {  
+ 
+//============================================================================= 
+ 
+/** receives notification of sax document events from a
+	<type>XFastParser</type>
+ */
+interface XFastDocumentHandler: XFastContextHandler
+{ 
+	//------------------------------------------------------------------------- 
+	 
+	/** called by the parser when parsing of an xml stream is started.
+	 */
+	void startDocument() 
+			raises( com::sun::star::xml::sax::SAXException ); 
+ 
+	//------------------------------------------------------------------------- 
+	 
+	/** called by the parser after the last xml element of a stream is processed.
+	 */
+	void endDocument() 
+			raises( com::sun::star::xml::sax::SAXException ); 
+
+	//------------------------------------------------------------------------- 
+	 
+	/** receives an object for locating the origin of SAX document events.
+	 */
+	void setDocumentLocator( [in] com::sun::star::xml::sax::XLocator xLocator ) 
+			raises( com::sun::star::xml::sax::SAXException ); 
+ 
+}; 
+ 
+//============================================================================= 
+ 
+}; }; }; }; };  
+ 
+#endif 
Index: offapi/com/sun/star/xml/sax/XFastParser.idl
===================================================================
RCS file: offapi/com/sun/star/xml/sax/XFastParser.idl
diff -N offapi/com/sun/star/xml/sax/XFastParser.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/xml/sax/XFastParser.idl	1 Mar 2007 17:33:12 -0000	1.1.2.2
@@ -0,0 +1,204 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: XFastParser.idl,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: cl $ $Date: 2007/03/01 17:33:12 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef __com_sun_star_xml_sax_XFastParser_idl__ 
+#define __com_sun_star_xml_sax_XFastParser_idl__ 
+ 
+#ifndef __com_sun_star_uno_XInterface_idl__ 
+#include <com/sun/star/uno/XInterface.idl> 
+#endif 
+ 
+#ifndef __com_sun_star_xml_sax_InputSource_idl__ 
+#include <com/sun/star/xml/sax/InputSource.idl> 
+#endif 
+ 
+#ifndef __com_sun_star_xml_sax_SAXException_idl__ 
+#include <com/sun/star/xml/sax/SAXException.idl> 
+#endif 
+ 
+#ifndef __com_sun_star_io_IOException_idl__ 
+#include <com/sun/star/io/IOException.idl> 
+#endif 
+ 
+#ifndef __com_sun_star_xml_sax_XFastDocumentHandler_idl__ 
+#include <com/sun/star/xml/sax/XFastDocumentHandler.idl> 
+#endif 
+
+#ifndef __com_sun_star_xml_sax_XFastTokenHandler_idl__ 
+#include <com/sun/star/xml/sax/XFastTokenHandler.idl> 
+#endif 
+
+#ifndef __com_sun_star_xml_sax_XErrorHandler_idl__ 
+#include <com/sun/star/xml/sax/XErrorHandler.idl> 
+#endif 
+ 
+#ifndef __com_sun_star_xml_sax_XDTDHandler_idl__ 
+#include <com/sun/star/xml/sax/XDTDHandler.idl> 
+#endif 
+ 
+#ifndef __com_sun_star_xml_sax_XEntityResolver_idl__ 
+#include <com/sun/star/xml/sax/XEntityResolver.idl> 
+#endif 
+ 
+#ifndef __com_sun_star_lang_Locale_idl__ 
+#include <com/sun/star/lang/Locale.idl> 
+#endif 
+ 
+#ifndef __com_sun_star_lang_IllegalArgumentException_idl__ 
+#include <com/sun/star/lang/IllegalArgumentException.idl> 
+#endif 
+ 
+//============================================================================= 
+ 
+module com {  module sun {  module star {  module xml {  module sax {  
+ 
+//============================================================================= 
+ 
+/** specifies a SAX parser that uses integer values for known xml names
+	(elements, attributes and attribute values). The parser also handles
+	namespaces and allows to have individual contexts for each xml element.
+
+	<p>Before parsing is possible you have to set your
+	<type>XFastDocumentHandler</type> using <member>setFastDocumentHandler</member>.
+	
+	<p>Parsing starts with calling <member>parseStream</member>. If the parser
+	finds a valid xml file with the given <type>InputSource</type>, it calls
+	<member>XFastDocumentHandler::startDocument</member> first.
+
+	<p>This parser generates either 'fast' events that use integer token
+	values for namespaces, elements and attributes or 'unknown' events for
+	elements that are unknown.
+
+	<p>A namespace is unknown if the namespace URL was not registered with
+	<member>registerNamespace</member>.
+
+	<p>An element is unknown if no <type>XFastTokenHandler</type> is set
+	or if the <type>XFastTokenHandler</type> does not return a valid
+	identifier for the elements local name. An element is also unknown if
+	the elements local name is known but it uses a namespace that is unknown.
+
+	<p>Setting a <type>XFastTokenHandler</type> with <member>setTokenHandler</member>
+	is optional, but without a <type>XFastTokenHandler</type> you will only
+	get unknown sax events. This can be usefull if you are only interested
+	in the namespace handling and/or the context feature.
+
+	<p>For each element the parser sends a create child element event to the
+	elements parent context by calling 
+	<member>XFastContextHandler::createFastChildContext</member> for known
+	elements or <member>XFastContextHandler::createUnknownChildContext</member>
+	for unknown elements.
+	<br>The parent context for the root element is the <type>XFastDocumentHandler</type>
+	itself.
+	
+	<p>If the parent context returns an empty reference, no further events for
+	the element and all of its childs are created.
+
+	<p>If a valid context is returned this context gets a start event by a call to
+	<member>XFastContextHandler::startFastElement</member> for known elements or
+	<member>XFastContextHandler::startUnknownElement</member> for unknown elements.
+
+	<p>After processing all its child elements the context gets an end event by a call to
+	<member>XFastContextHandler::endFastElement</member> for known elements or
+	<member>XFastContextHandler::endUnknownElement</member> for unknown elements.
+
+	<p>It is valid to return one instance of <type>XFastContextHandler</type> more
+	than once. It is even possible to only use the <type>XFastDocumentHandler</type>
+	by always returning a reference to itself for each create child context event.
+
+	<p>After the last element is processed the parser generates an end document
+	event at the <type>XFastDocumentHandler</type> by calling
+	<member>XFastDocumentHandler::endDocument</member>.
+
+	@see http://wiki.services.openoffice.org/wiki/FastParser
+*/
+interface XFastParser: com::sun::star::uno::XInterface
+{ 
+	//------------------------------------------------------------------------- 
+	/** parses an XML document from a stream. 
+		
+		<p>Set the desired handlers before calling this method.</p>
+	 */
+	void parseStream( [in] InputSource aInputSource ) 
+			raises( SAXException, com::sun::star::io::IOException ); 
+ 
+	//------------------------------------------------------------------------- 
+	
+	/** Application must register a document event handler to get
+		sax events for the parsed stream.
+	 */
+	void setFastDocumentHandler( [in] XFastDocumentHandler Handler ); 
+
+	//------------------------------------------------------------------------- 
+	
+	/** must be registered to translate known xml names to integer tokens.
+	 */
+	void setTokenHandler( [in] XFastTokenHandler Handler ); 
+
+	//------------------------------------------------------------------------- 
+
+	/** registers a known namespace url with the given integer token.<br>
+		@param NamespaceToken
+			an integer token that must be greater than FastToken::NAMESPACE.
+	 */
+	void registerNamespace( [in] string NamespaceURL, [in] long NamespaceToken )
+		raises( com::sun::star::lang::IllegalArgumentException ); 
+
+	//------------------------------------------------------------------------- 
+	/** allows an application to register an error event handler. 
+		
+		<p>Note that the error handler can throw an exception when an error or 
+		warning occurs.  Note that an exception is thrown by the parser when 
+		an unrecoverable (fatal) error occurs.</p>
+	 */
+	void setErrorHandler( [in] XErrorHandler Handler ); 
+ 
+	//------------------------------------------------------------------------- 
+	/** allows an application to register a DTD-Handler.
+	 */
+	void setEntityResolver( [in] XEntityResolver Resolver ); 
+ 
+	//------------------------------------------------------------------------- 
+	/** sets a locale specified for localization of warnings and error messages.
+		
+		<p>Set the language of the error messages. Useful when the parsing 
+		errors will be presented to the user.</p>
+	 */
+	void setLocale( [in] com::sun::star::lang::Locale locale ); 
+}; 
+ 
+//============================================================================= 
+ 
+}; }; }; }; };  
+ 
+#endif 
Index: offapi/com/sun/star/xml/sax/XFastTokenHandler.idl
===================================================================
RCS file: offapi/com/sun/star/xml/sax/XFastTokenHandler.idl
diff -N offapi/com/sun/star/xml/sax/XFastTokenHandler.idl
--- /dev/null	1 Jan 1970 00:00:00 -0000
+++ offapi/com/sun/star/xml/sax/XFastTokenHandler.idl	1 Mar 2007 17:33:12 -0000	1.1.2.2
@@ -0,0 +1,94 @@
+/*************************************************************************
+ *
+ *  OpenOffice.org - a multi-platform office productivity suite
+ *
+ *  $RCSfile: XFastTokenHandler.idl,v $
+ *
+ *  $Revision: 1.1.2.2 $
+ *
+ *  last change: $Author: cl $ $Date: 2007/03/01 17:33:12 $
+ *
+ *  The Contents of this file are made available subject to
+ *  the terms of GNU Lesser General Public License Version 2.1.
+ *
+ *
+ *    GNU Lesser General Public License Version 2.1
+ *    =============================================
+ *    Copyright 2005 by Sun Microsystems, Inc.
+ *    901 San Antonio Road, Palo Alto, CA 94303, USA
+ *
+ *    This library is free software; you can redistribute it and/or
+ *    modify it under the terms of the GNU Lesser General Public
+ *    License version 2.1, as published by the Free Software Foundation.
+ *
+ *    This library is distributed in the hope that it will be useful,
+ *    but WITHOUT ANY WARRANTY; without even the implied warranty of
+ *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ *    Lesser General Public License for more details.
+ *
+ *    You should have received a copy of the GNU Lesser General Public
+ *    License along with this library; if not, write to the Free Software
+ *    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
+ *    MA  02111-1307  USA
+ *
+ ************************************************************************/
+#ifndef __com_sun_star_xml_sax_XFastTokenHandler_idl__ 
+#define __com_sun_star_xml_sax_XFastTokenHandler_idl__ 
+ 
+#ifndef __com_sun_star_uno_XInterface_idl__ 
+#include <com/sun/star/uno/XInterface.idl> 
+#endif 
+ 
+//============================================================================= 
+ 
+module com {  module sun {  module star {  module xml {  module sax {  
+ 
+//============================================================================ 
+ 
+/** interface to translate xml strings to integer tokens.
+
+	<p>An instance of this interface can be registered at a <type>XFastParser</type>.
+	It should be able to translate all xml names (element local names,
+	attribute local names and constant attribute values) to integer tokens.
+
+	A token value must be greater or equal to zero and less than 
+	<const>FastToken::NAMESPACE</const>. If a string identifier is not known
+	to this instance, <const>FastToken::DONTKNOW</const> is returned.
+ */
+interface XFastTokenHandler: com::sun::star::uno::XInterface
+{ 
+	//------------------------------------------------------------------------- 
+
+	/**	returns a integer token for the given string identifier.
+
+		@returns
+			a unique integer token for the given String or <const>FastToken::DONTKNOW</const
+			if the identifier is not known to this instance.
+	*/
+	long getToken( [in] string Identifier );
+
+	//------------------------------------------------------------------------- 
+
+	/** returns a string identifier for the given integer token.
+	*/
+	string getIdentifier( [in] long Token );
+
+	//------------------------------------------------------------------------- 
+
+	/** returns a integer token for the given string
+
+		@param Identifier
+			the string given as a byte sequence encoded in UTF8
+
+		@returns
+			a unique integer token for the given String or <const>FastToken::DONTKNOW</const>
+			if the identifier is not known to this instance.
+	*/
+	long getTokenFromUTF8( [in] sequence< byte > Identifier );
+}; 
+
+//============================================================================ 
+
+}; }; }; }; };  
+ 
+#endif 
Index: offapi/com/sun/star/xml/sax/makefile.mk
===================================================================
RCS file: /cvs/api/offapi/com/sun/star/xml/sax/makefile.mk,v
retrieving revision 1.6
retrieving revision 1.6.40.2
diff -u -b -I $Revision.*$ -I $Author.*$ -r1.6 -r1.6.40.2
--- offapi/com/sun/star/xml/sax/makefile.mk	1 Dec 2006 17:21:41 -0000	1.6
+++ offapi/com/sun/star/xml/sax/makefile.mk	1 Mar 2007 17:33:03 -0000	1.6.40.2
@@ -58,6 +58,12 @@
 	XExtendedDocumentHandler.idl\
 	XLocator.idl\
 	XParser.idl\
+	XFastParser.idl\
+	XFastDocumentHandler.idl\
+	XFastContextHandler.idl\
+	XFastTokenHandler.idl\
+	XFastAttributeList.idl\
+	FastToken.idl
 
 # ------------------------------------------------------------------
 
